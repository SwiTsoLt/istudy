<div class="room bgimage">
  <div class="container">
    <div class="title">
      <h1>Комната</h1>
    </div>
    <div class="interface">
      <p class="status"><strong>Статус подключения:</strong><span>{{ (isConnected$ | async) ? 'подключено успешно': 'не подключено' }}</span></p>
      <p class="status"><strong>Код комнаты:</strong><span>{{ roomCode$ | async }}</span></p>
      <!-- <p class="status"><strong>Сообщения:</strong><span>{{ messageLabel$ | async }}</span></p> -->
    </div>

    <div class="buttons">
      <button *ngIf="!(isConnected$ | async) && !(isOwner$ | async)" (click)="create()">Создать</button>
      <button *ngIf="!(isConnected$ | async) && !(isOwner$ | async)" (click)="showJoinerPopup()">Присоединиться</button>
      <button class="leaveBtn" *ngIf="(isOwner$ | async) && (isConnected$ | async)" (click)="removeRoom()">Удалить
        комнату</button>
      <button class="leaveBtn" *ngIf="!(isOwner$ | async) && (isConnected$ | async)" (click)="leaveRoom()">Выйти</button>
    </div>

    <div *ngIf="(showOwnerPopupState$ | async) && !(isConnected$ | async)" class="popup">
      <div *ngIf="isReady$ | async; else notReady" class="form">
        <qrcode [qrdata]="(inviteQrCodeUrl$ | async) || '' " [width]="256" errorCorrectionLevel="Q" elementType="url">
        </qrcode>
        <div class="roomCode">{{ roomCode$ | async }}</div>
        <!-- <p>{{ messageLabel$ | async }}</p> -->
        <p>Ожидание подключения...</p>
        <button (click)="removeRoom()">Выйти</button>
      </div>
    </div>

    <div *ngIf="(showJoinerPopupState$ | async) && !(isConnected$ | async)" class="popup">
      <div *ngIf="isReady$ | async; else notReady" class="form">
        <!-- <p>{{ messageLabel$ | async }}</p> -->
        <h2>Введите код комнаты</h2>
        <input #roomCodeInput (keydown.enter)="joinRoom(roomCodeInput.value)" type="text" placeholder="Код комнаты"
          (input)="roomCodeInput.value.length > 5 && (roomCodeInput.value = roomCodeInput.value.slice(0, 5))"
          type="number">
        <button (click)="joinRoom(roomCodeInput.value)">Присоединиться</button>
        <button (click)="closeJoinerPopup()">Закрыть</button>
      </div>
    </div>
    
    <ng-template #notReady>
      <app-loader></app-loader>
    </ng-template>

    <div class="selectorContainer">
      <router-outlet></router-outlet>
    </div>
  </div>